Mem.rule.item.set <%= JSON.generate MESSAGE.sow %>
if gon?.items?
  Mem.rule.item.merge gon.items

<% MESSAGE.module.sow.each do |name| %>
GUI.items_module "<%= name %>"
<% end %>


deploy_samples = ->
  deploy = (role, call)->
    chr_job_id = "all_c"
    chr_job_id = "all_c0" if faceno in [1..10]
    chr_job_id += faceno

    turns = ["start", "main"]
    is_main = false
    for able in role.ables when able not in ["vote", "entrust"]
      is_main ||= Mem.ables.find(able).at.main

    turns = ["main"] if is_main

    for turn in turns
      data = call(turn, chr_job_id, index)
      Mem.rule.item.merge [data] if data?
      index += 1
    faceno += 1
    faceno += 1 if faceno ==  6
    faceno += 1 if faceno == 10

  faceno = 1
  index = 10

  for role in Mem.roles.where(group: "MOB").list()
    deploy role, (turn, chr_job_id, index)->
      return if "start" == turn
      mob: role._id
      enemy: "evil"
      turn: turn
      chr_job_id: chr_job_id
      _id: "rolelist-form--#{index}"
      win: "NONE"
      live: "mob"
      role: ["mob"]
      ext: [role._id]
      rolestate: 0x76f
      sheep: []
      love: null

  for role in Mem.roles.where(group: "LIVE").list()
    deploy role, (turn, chr_job_id, index)->
      return if "start" == turn
      mob: "visiter"
      enemy: "evil"
      turn: turn
      chr_job_id: chr_job_id
      _id: "rolelist-form--#{index}"
      win: "HUMAN"
      live: role._id
      role: ["villager"]
      rolestate: 0x76f
      sheep: []
      love: null

  for rolename in SOW_RECORD.roles when role = Mem.roles.find(rolename)
    deploy role, (turn, chr_job_id, index)->
      mob: "visiter"
      enemy: "evil"
      turn: turn
      chr_job_id: chr_job_id
      _id: "rolelist-form--#{index}"
      win: role.win || "NONE"
      live: "live"
      role: [role._id]
      rolestate: 0x76f
      sheep: []
      love: null

  for rolename in SOW_RECORD.gifts when role = Mem.roles.find(rolename)
    for subrolename in ["lonewolf"]
      subrole = Mem.roles.find(subrolename)
      deploy role, (turn, chr_job_id, index)->
        mob: "visiter"
        enemy: "evil"
        turn: "main"
        chr_job_id: chr_job_id
        _id: "rolelist-form--#{index}"
        win: role.win || subrole.win || "NONE"
        live: "live"
        role: [subrolename, rolename]
        rolestate: 0x76f
        sheep: []
        love: null

  forms = Mem.items.where(template: "form").list()
  Mem.rule.story.merge [
    _id: "morphe-126"
    folder: "MORPHE"
    is_epilogue: true
    is_finish: false
    options: ["select-role"]
    timer:
      updateddt:    1439222662000
      nextupdatedt: 1440430200000
      nextchargedt: 1440430200000
      nextcommitdt: 1440003600000
      scraplimitdt: 1439739000000
    type:
      mob:"grave"
      say:"vulcan"
      vote:"anonymity"
      game:"TABULA"
    card:
      config: []
      event: []
      role: []
    vpl: [20]
    upd:
      interval:1
      hour:0
      minute:30
  ]
  Mem.rule.event.merge [
    story_id: "morphe-126"
    turn: 9
  ]
  Mem.rule.potof.merge [
    {"bonds":[],"clearance":1,"csid":"all","deathday":2,"event_id":"morphe-126-9","face_id":"all","history":null,"jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":1,"point":{"actaddpt":12,"saidcount":0,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["villager"],"rolestate":-1,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"villager","sheep":null,"sow_auth_id":"master","story_id":"morphe-126","timer":{"entrieddt":1439222662000,"limitentrydt":0},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":7,"event_id":"morphe-126-9","face_id":"c56","history":null,"jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":2,"point":{"actaddpt":12,"saidcount":4,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["hunter"],"rolestate":248,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":null,"sheep":"pixi","sow_auth_id":"icemaze00","story_id":"morphe-126","timer":{"entrieddt":1439478917000,"limitentrydt":1440516427000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":7,"event_id":"morphe-126-9","face_id":"t10","history":"<b>1日目</b>の夜、<b>ヨーランダ</b>と<b>サミュエル</b>を誘い込んだ。<br><b>2日目</b>の夜、<b>オルギア</b>と<b>ジャック</b>を誘い込んだ。<br><b>3日目</b>の夜、<b>ケイイチ</b>と<b>丁助</b>を誘い込んだ。<br><b>4日目</b>の夜、<b>アオイ</b>と<b>小鈴</b>を誘い込んだ。<br><b>5日目</b>の夜、<b>ゴドウィン</b>と<b>辰次</b>を誘い込んだ。<br>","jobname":null,"live":"executed","love":null,"name":null,"overhear":[],"pno":3,"point":{"actaddpt":12,"saidcount":5,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["guru"],"rolestate":255,"say":{"say":40296,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":40296,"say_act":144},"select":"loveangel","sheep":null,"sow_auth_id":"唐花","story_id":"morphe-126","timer":{"entrieddt":1439478915000,"limitentrydt":1440516315000},"user_id":null,"zapcount":0}
    {"bonds":["18","2"],"clearance":1,"csid":"all","deathday":6,"event_id":"morphe-126-9","face_id":"t22","history":"<b>1日目</b>の夜、<b>ジャック</b>が<b>あなた</b>と運命を分かち合いました。<br>","jobname":null,"live":"suicide","love":"love","name":null,"overhear":[],"pno":4,"point":{"actaddpt":12,"saidcount":2,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["guard"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"witch","sheep":"pixi","sow_auth_id":"sazanami","story_id":"morphe-126","timer":{"entrieddt":1439479129000,"limitentrydt":1440516457000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":8,"event_id":"morphe-126-9","face_id":"m04","history":"<b>サミュエル</b>は<b>信仰霊能者</b>のようだ。<br><b>ジャック</b>は<b>守護者</b>のようだ。<br><b>トレイル</b>は<b>笛吹き</b>のようだ。<br><b>丁助</b>は<b>仔狼</b>のようだ。<br><b>小鈴</b>は<b>恋愛天使</b>のようだ。<br><b>スージー</b>は<b>魔女</b>のようだ。<br>","jobname":null,"live":"executed","love":null,"name":null,"overhear":[],"pno":5,"point":{"actaddpt":12,"saidcount":3,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["sorcerer"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"lover","sheep":"pixi","sow_auth_id":"Marionette","story_id":"morphe-126","timer":{"entrieddt":1439315676000,"limitentrydt":1440356449000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-1,"event_id":"morphe-126-0","face_id":"c23","history":null,"jobname":null,"live":"live","love":null,"name":null,"overhear":[],"pno":6,"point":{"actaddpt":3,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":[null],"rolestate":-1,"say":{"say":3000,"tsay":1000,"spsay":1500,"wsay":4000,"xsay":null,"gsay":3000,"say_act":36},"select":"bat","sheep":null,"sow_auth_id":"suikei","story_id":"morphe-126","timer":{"entrieddt":1439316955000,"limitentrydt":1439489755000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-2,"event_id":"morphe-126-0","face_id":"c116","history":null,"jobname":null,"live":"mob","love":null,"name":null,"overhear":[],"pno":7,"point":{"actaddpt":3,"saidcount":2,"saidpoint":25},"pseudobonds":[],"pseudolove":null,"role":[null],"rolestate":-1,"say":{"say":3000,"tsay":1000,"spsay":1500,"wsay":4000,"xsay":null,"gsay":2976,"say_act":35},"select":null,"sheep":null,"sow_auth_id":"lobelia","story_id":"morphe-126","timer":{"entrieddt":1439325701000,"limitentrydt":1439560997000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-1,"event_id":"morphe-126-0","face_id":"t24","history":null,"jobname":null,"live":"live","love":null,"name":null,"overhear":[],"pno":8,"point":{"actaddpt":3,"saidcount":10,"saidpoint":239},"pseudobonds":[],"pseudolove":null,"role":[null],"rolestate":-1,"say":{"say":2763,"tsay":1000,"spsay":1500,"wsay":4000,"xsay":null,"gsay":3000,"say_act":34},"select":"lover","sheep":null,"sow_auth_id":"ameyoru","story_id":"morphe-126","timer":{"entrieddt":1439337503000,"limitentrydt":1439642566000},"user_id":null,"zapcount":0}
    {"bonds":["14"],"clearance":1,"csid":"all","deathday":6,"event_id":"morphe-126-9","face_id":"sf17","history":"<b>1日目</b>の夜、<b>あなた</b>は<b>ケイイチ</b>と運命を分かち合いました。<br><b>3日目</b>の夜、<b>ケイイチ</b>を襲撃から守った。<br>","jobname":null,"live":"suicide","love":null,"name":null,"overhear":[],"pno":9,"point":{"actaddpt":12,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["guard"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"lover","sheep":"pixi","sow_auth_id":"hesychia","story_id":"morphe-126","timer":{"entrieddt":1439479527000,"limitentrydt":1440233023000},"user_id":null,"zapcount":0}
    {"bonds":["14"],"clearance":1,"csid":"all","deathday":6,"event_id":"morphe-126-9","face_id":"w04","history":"<b>1日目</b>の夜、<b>小鈴</b>と<b>ケイイチ</b>の間に運命の絆を結んだ。<br>","jobname":null,"live":"cursed","love":"love","name":null,"overhear":[],"pno":10,"point":{"actaddpt":12,"saidcount":8,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["loveangel"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"loveangel","sheep":"pixi","sow_auth_id":"yucca","story_id":"morphe-126","timer":{"entrieddt":1439358537000,"limitentrydt":1440516563000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":4,"event_id":"morphe-126-9","face_id":"t34","history":null,"jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":11,"point":{"actaddpt":12,"saidcount":16,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["invalid"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"invalid","sheep":null,"sow_auth_id":"scarecrow","story_id":"morphe-126","timer":{"entrieddt":1439479300000,"limitentrydt":1440516563000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":6,"event_id":"morphe-126-9","face_id":"mad11","history":"<b>1日目</b>の夜、<b>モスキート</b>と<b>ソフィア</b>の間に運命の絆を結んだ。<br>","jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":12,"point":{"actaddpt":12,"saidcount":0,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["loveangel"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"loveangel","sheep":"pixi","sow_auth_id":"geppei","story_id":"morphe-126","timer":{"entrieddt":1439479200000,"limitentrydt":1440349986000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-1,"event_id":"morphe-126-9","face_id":"c111","history":"<b>4日目</b>の夜、<b>ゴドウィン</b>を<b>蘇生</b>した。<br><b>5日目</b>の夜、<b>小鈴</b>を<b>殺害</b>した。<br>","jobname":null,"live":"live","love":null,"name":null,"overhear":[],"pno":13,"point":{"actaddpt":12,"saidcount":3,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["witch"],"rolestate":252,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"witch","sheep":null,"sow_auth_id":"benico","story_id":"morphe-126","timer":{"entrieddt":1439479057000,"limitentrydt":1440514205000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":5,"event_id":"morphe-126-9","face_id":"t06","history":"<b>モスキート</b>は<b>恋人陣営</b>のようだ。<br><b>ゴドウィン</b>は<b>村人陣営</b>のようだ。<br>","jobname":null,"live":"executed","love":null,"name":null,"overhear":[],"pno":14,"point":{"actaddpt":12,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["mediumwin"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":null,"sheep":"pixi","sow_auth_id":"轟","story_id":"morphe-126","timer":{"entrieddt":1439478948000,"limitentrydt":1440262462000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":3,"event_id":"morphe-126-9","face_id":"m19","history":null,"jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":15,"point":{"actaddpt":12,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["hunter"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"seerwin","sheep":null,"sow_auth_id":"narumi","story_id":"morphe-126","timer":{"entrieddt":1439478932000,"limitentrydt":1440516450000},"user_id":null,"zapcount":0}
    {"bonds":["8"],"clearance":1,"csid":"all","deathday":3,"event_id":"morphe-126-9","face_id":"c67","history":"<b>1日目</b>の夜、<b>あなた</b>は<b>モスキート</b>と運命を分かち合いました。<br>","jobname":null,"live":"suicide","love":"love","name":null,"overhear":[],"pno":16,"point":{"actaddpt":12,"saidcount":14,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["passion"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"passion","sheep":null,"sow_auth_id":"tear_stone","story_id":"morphe-126","timer":{"entrieddt":1439478773000,"limitentrydt":1440516452000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-2,"event_id":"morphe-126-9","face_id":"w13","history":null,"jobname":null,"live":"mob","love":null,"name":null,"overhear":[],"pno":17,"point":{"actaddpt":12,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":[null],"rolestate":-1,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":null,"sheep":null,"sow_auth_id":"pure_g","story_id":"morphe-126","timer":{"entrieddt":1439443194000,"limitentrydt":1440515364000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":5,"event_id":"morphe-126-9","face_id":"c51","history":"<b>モスキート</b>は<b>恋人陣営</b>のようだ。<br><b>ジャック</b>は<b>村人陣営</b>のようだ。<br><b>ドン</b>は<b>村人陣営</b>のようだ。<br><b>アオイ</b>は<b>裏切りの陣営</b>のようだ。<br>","jobname":null,"live":"victim","love":null,"name":null,"overhear":[],"pno":18,"point":{"actaddpt":12,"saidcount":0,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["seerwin"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"seerwin","sheep":"pixi","sow_auth_id":"springkraut","story_id":"morphe-126","timer":{"entrieddt":1439479225000,"limitentrydt":1440375099000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-2,"event_id":"morphe-126-9","face_id":"c60","history":null,"jobname":null,"live":"mob","love":null,"name":null,"overhear":[],"pno":19,"point":{"actaddpt":12,"saidcount":1,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":[null],"rolestate":-1,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":null,"sheep":null,"sow_auth_id":"navi_chang","story_id":"morphe-126","timer":{"entrieddt":1439468865000,"limitentrydt":1440516549000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":6,"event_id":"morphe-126-9","face_id":"w24","history":"<b>1日目</b>の夜、<b>パルック</b>を<b>殺害</b>した。<b>パルック</b>は<b>村人</b>のようだ。<br><b>2日目</b>の夜、<b>タルト</b>を<b>殺害</b>した。<b>タルト</b>は<b>賞金稼</b>のようだ。<br><b>4日目</b>の夜、<b>ヨーランダ</b>を<b>殺害</b>した。<b>ヨーランダ</b>は<b>信仰占師</b>のようだ。<br>","jobname":null,"live":"executed","love":null,"name":null,"overhear":[],"pno":20,"point":{"actaddpt":12,"saidcount":9,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["intwolf"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"intwolf","sheep":"pixi","sow_auth_id":"＠寿司","story_id":"morphe-126","timer":{"entrieddt":1439469093000,"limitentrydt":1440514019000},"user_id":null,"zapcount":0}
    {"bonds":[],"clearance":1,"csid":"all","deathday":-1,"event_id":"morphe-126-9","face_id":"w50","history":"<b>1日目</b>の夜、<b>パルック</b>を<b>殺害</b>した。<br><b>2日目</b>の夜、<b>タルト</b>を<b>殺害</b>した。<br><b>4日目</b>の夜、<b>ヨーランダ</b>を<b>殺害</b>した。<br><b>5日目</b>の夜、<b>オルギア</b>を<b>殺害</b>した。<br><b>6日目</b>の夜、<b>ゴドウィン</b>を<b>殺害</b>した。<br>","jobname":null,"live":"live","love":null,"name":null,"overhear":[],"pno":21,"point":{"actaddpt":11,"saidcount":15,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["childwolf"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"semiwolf","sheep":"pixi","sow_auth_id":"k_karura","story_id":"morphe-126","timer":{"entrieddt":1439475167000,"limitentrydt":1440516530000},"user_id":null,"zapcount":0}
    {"bonds":["7"],"clearance":1,"csid":"all","deathday":3,"event_id":"morphe-126-9","face_id":"sf027","history":"<b>1日目</b>の夜、<b>パルック</b>を<b>殺害</b>した。<br>","jobname":null,"live":"executed","love":"love","name":null,"overhear":[],"pno":22,"point":{"actaddpt":12,"saidcount":5,"saidpoint":0},"pseudobonds":[],"pseudolove":null,"role":["headless"],"rolestate":255,"say":{"say":39996,"tsay":4000,"spsay":6000,"wsay":16000,"xsay":null,"gsay":39996,"say_act":144},"select":"loveangel","sheep":null,"sow_auth_id":"Aigis","story_id":"morphe-126","timer":{"entrieddt":1439478829000,"limitentrydt":1440516408000},"user_id":null,"zapcount":0}
  ]
  Mem.rule.form.merge forms

deploy_samples()
